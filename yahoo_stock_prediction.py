# -*- coding: utf-8 -*-
"""Yahoo_Stock_Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1CbA4lXxgG5gIPTFgLEDqNuPylD6Co_HY
"""
from stock_utils import get_stock_data
from utils import setup_logging
from mysql_utils import init_db, create_table_from_dataframe
import logging
import matplotlib.pyplot as plt
import pandas as pd

setup_logging("runtime.log")

STOCK_SYMBOL = "GC=Fa"
db = init_db()

try:
  logging.info(f"Downloading stock data for {STOCK_SYMBOL} .....")
  stock_data = get_stock_data(STOCK_SYMBOL)
  logging.info(f"Writting {STOCK_SYMBOL} into database .....")
  create_table_from_dataframe(stock_data, STOCK_SYMBOL)
  logging.info(f"Writting {STOCK_SYMBOL} into database finished")
except Exception as err:
  logging.error(err)

db.close()



# stock_data

# stock_data.index = pd.to_datetime(stock_data.index).date
# stock_data = stock_data.rename_axis("Date")
# stock_data

# data = stock_data[["Close"]]
# data = data.rename(columns={"Close": "Price"})
# data

# data["P5"] = data["Price"].rolling(5).mean()
# data["P7"] = data["Price"].rolling(7).mean()
# data.head(15)

# data = data.dropna()
# data